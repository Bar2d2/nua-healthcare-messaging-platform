<%# Show user switcher in all environments for demo purposes %>
<% if true # enabled for demo purposes %>
  <% if current_user %>
    <div class="dropdown" data-turbo-permanent>
      <button class="btn btn-outline-secondary btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
        <%= role_icon(current_user.role) %> <%= current_user.role.capitalize %>
        <small class="text-muted">(<%= current_user.first_name %>)</small>
      </button>
    <ul class="dropdown-menu">
      <li class="dropdown-header">🎭 Demo Mode - Switch User Role</li>
      <li><hr class="dropdown-divider"></li>

      <li>
        <%= button_to "👩‍⚕️ Patient",
                      switch_to_patient_path,
                      method: :post,
                      class: "dropdown-item #{'active' if current_user.role == 'patient'}",
                      form: { style: 'display: inline;', data: { turbo: false } } %>
      </li>
      <li>
        <%= button_to "🩺 Doctor",
                      switch_to_doctor_path,
                      method: :post,
                      class: "dropdown-item #{'active' if current_user.role == 'doctor'}",
                      form: { style: 'display: inline;', data: { turbo: false } } %>
      </li>
      <li>
        <%= button_to "⚙️ Admin",
                      switch_to_admin_path,
                      method: :post,
                      class: "dropdown-item #{'active' if current_user.role == 'admin'}",
                      form: { style: 'display: inline;', data: { turbo: false } } %>
      </li>

      <li><hr class="dropdown-divider"></li>
      <li>
        <%= button_to "🔄 Reset to Default",
                      clear_user_switch_path,
                      method: :post,
                      class: "dropdown-item text-muted",
                      form: { style: 'display: inline;', data: { turbo: false } } %>
      </li>
    </ul>
    </div>
  <% end %>
<% end %>

<% content_for :head do %>
  <style>
    .dropdown-item.active {
      background-color: var(--bs-primary);
      color: white;
    }
    .dropdown form {
      margin: 0;
    }
  </style>
<% end %>
